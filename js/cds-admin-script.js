$ = jQuery.noConflict();$(document).ready(function($) {	$(document).on('click','.add_field',function(){		var id = $(this).data('id');		var num = $('ul.list_'+id+' li').size();		var name = $(this).data('name');		name = name+' '+num;		var field = '<li>'+name+' <input type="text" title="Remove" name="'+id+'[name][]"><input type="text" title="Remove" name="'+id+'[link][]"><span class="dashicons dashicons-dismiss field-remove"></span></li>';		$('ul.list_'+id+' > :last-child').before(field);	});	$(document).on('click','.field-remove',function(){		$(this).parent().remove();	});			var match_cat = 'cds_';	var con = match_cat+'Activetab';	//Color Picker Initialization	//navigation	$('.group').hide();	var pdActivetab = '';	if (typeof(localStorage) != 'undefined' ) {		pdActivetab = localStorage.getItem(con);	}	if (pdActivetab != '' && $(pdActivetab).length ) {		$(pdActivetab).fadeIn();	} else {		$('.group:first').fadeIn();	}	$('.group .collapsed').each(function(){		$(this).find('input:checked').parent().parent().parent().nextAll().each(		function(){			if ($(this).hasClass('last')) {				$(this).removeClass('hidden');				return false;			}			$(this).filter('.hidden').removeClass('hidden');		});	});	if (pdActivetab != '' && $(pdActivetab + '-tab').length ) {		$(pdActivetab + '-tab').addClass('nav-tab-active');	}	else {		$('.nav-tab-wrapper a:first').addClass('nav-tab-active');	}	$('.nav-tab-wrapper a').click(function(evt) {		$('.nav-tab-wrapper a').removeClass('nav-tab-active');		$(this).addClass('nav-tab-active').blur();		var clicked_group = $(this).attr('href');		if (typeof(localStorage) != 'undefined' ) {			var pdStr = $(this).attr('href');			var Valid = pdStr.match(match_cat);			if(Valid){				localStorage.setItem(con, pdStr);			}		}		$('.group').hide();		$(clicked_group).fadeIn();		evt.preventDefault();	});	//Image upload	var file_frame = [];	$.fn.uploadMediaFile = function( button, preview_media,multiple=false ) {		var button_id = button.attr('id');		var field_id = button_id.replace( '_button', '' );		var preview_id = button_id.replace( '_button', '_preview' );				// If the media frame already exists, reopen it.		if ( file_frame[button_id] ) {		  file_frame[button_id].open();		  return;		}		// Create the media frame.		file_frame[button_id] = wp.media.frames.file_frame = wp.media({		  title: $( this ).data( 'uploader_title' ),		  button: {			text: $( this ).data( 'uploader_button_text' ),		  },		  multiple: multiple		});		// When an image is selected, run a callback.		file_frame[button_id].on( 'select', function() {			if(multiple){				attachment = file_frame[button_id].state().get('selection').map(function(attachment){					attachment.toJSON();					return attachment;				});				var appenID = field_id+'_list';				for (i = 0; i < attachment.length; ++i) {					var main = attachment[i].attributes;					$("#"+appenID).append($.fn.ppp_add(main,field_id));				}			}else{				attachment = file_frame[button_id].state().get('selection').first().toJSON();				$("#"+field_id).val(attachment.id);				if( preview_media ) {					$("#"+preview_id).show();					$("#"+preview_id).attr('src',attachment.sizes.thumbnail.url);				}			}		});		// Finally, open the modal		file_frame[button_id].open();	}	$.fn.ppp_add = function(value,id) {		var markup = '';		markup += '<li class="single-image"  id="image-remove-'+value.id+'">'; 			markup += '<span data-image-pos-id="'+value.id+'" class="dashicons dashicons-dismiss image-remove"></span>';      			markup += '<image class="preview-image" height="50px" width="50px" src="'+value.url+'" >';      			markup += '<input type="hidden" name="'+id+'['+value.id+']" value="'+value.id+'" class="preview-image" >';		markup += '</li>';		return markup;	}	$('.image_upload_button').click(function() {		$.fn.uploadMediaFile( $(this), true);	});	$('.image_delete_button').click(function() {		var imagstr = $(this).attr('id');		var res = imagstr.replace("_delete", "");		$('#'+res).val(' ');		$( '.image_preview' ).hide();		return false;	});});		